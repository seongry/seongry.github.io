{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021/12-05-try-to-use-msw-on-testing/","result":{"data":{"site":{"siteMetadata":{"title":"ì½”ì•Œ ë°ë¸Œ ë¡œê·¸","author":"SeongRyeong Kim"}},"markdownRemark":{"id":"9d4842ef-c60f-583d-b25d-b80ffb21aa20","excerpt":"íšŒì‚¬ì—ì„œ ë„ì…í•´ë³´ê³  ê´œì°®ì•˜ë˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© í›„ê¸°.\nì‚¬ë‚´ì—ì„œ ê³µìœ í•˜ë ¤ê³  ì‘ì„±í–ˆë˜ ê¸€ì¸ë° ë¸”ë¡œê·¸ì—ë„ ì˜¬ë ¤ë³¸ë‹¤ ğŸ˜Š MSWë€? MSW(Mocking Service Worker)ëŠ” ì„œë¹„ìŠ¤ ì›Œì»¤ APIë¥¼ ì´ìš©í•´ì„œ ì‹¤ì œ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ì¸í„°ì…‰íŠ¸í•˜ëŠ” APIâ€¦","html":"<p>íšŒì‚¬ì—ì„œ ë„ì…í•´ë³´ê³  ê´œì°®ì•˜ë˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© í›„ê¸°.\nì‚¬ë‚´ì—ì„œ ê³µìœ í•˜ë ¤ê³  ì‘ì„±í–ˆë˜ ê¸€ì¸ë° ë¸”ë¡œê·¸ì—ë„ ì˜¬ë ¤ë³¸ë‹¤ ğŸ˜Š</p>\n<h1>MSWë€?</h1>\n<p>MSW(Mocking Service Worker)ëŠ” ì„œë¹„ìŠ¤ ì›Œì»¤ APIë¥¼ ì´ìš©í•´ì„œ ì‹¤ì œ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ì¸í„°ì…‰íŠ¸í•˜ëŠ” API ëª¨í‚¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.</p>\n<h2>ì‚¬ìš©í–ˆì„ë•Œ ì´ì </h2>\n<ul>\n<li>ì‹¤ì œ APIê°€ ê°œë°œë˜ê¸° ì „ì— APIë¥¼ ëª¨í‚¹í•´ì„œ ì—†ëŠ” APIë¥¼ ê°€ì§€ê³  ë¯¸ë¦¬ ê°œë°œì„ ì§„í–‰í•  ìˆ˜ ìˆì–´ì„œ ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆë‹¤.</li>\n<li>í…ŒìŠ¤íŠ¸ì½”ë“œ ì‘ì„±ì‹œ apií†µì‹ ì„ íšŒí”¼í•˜ê¸°ìœ„í•œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.</li>\n</ul>\n<h2>axios-mock-adapter ì™€ì˜ ì°¨ì´ì ì€?</h2>\n<p>ê²°ê³¼ë¬¼ ìì²´ëŠ” ë™ì¼í• ì§€ ëª¨ë¥´ë‚˜ MSWëŠ” <code class=\"language-text\">ì„œë¹„ìŠ¤ì›Œì»¤</code>ì˜ ì¡´ì¬ë¡œ ì¸í•´ ì°¨ì´ì ì´ ìƒê¸´ë‹¤.\nMSWì—ì„œ ì„œë¹„ìŠ¤ì›Œì»¤ëŠ” ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ì—ì„œ ìš”ì²­ì„ ê°€ë¡œì±„ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆê¸°ë•Œë¬¸ì— ë‹¤ë¥¸ mocking ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ë¹„í•´ ì—¬ëŸ¬ê°€ì§€ ì´ì ì„ ê°€ì§„ë‹¤.</p>\n<ul>\n<li>mockingì˜ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ë™ì¼í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ì‘ì„ ë³´ì¥í•œë‹¤.</li>\n<li>ì¢€ ë” ìœ ì €ê°€ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì²˜ëŸ¼ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<h1>í…ŒìŠ¤íŠ¸ í™˜ê²½ì— MSW ì„¸íŒ…í•˜ê¸°</h1>\n<h3>íŒ¨í‚¤ì§€ ì„¤ì¹˜</h3>\n<p>ê°€ì¥ ë¨¼ì € íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">yarn add msw <span class=\"token operator\">--</span>dev</code></pre></div>\n<h3>handlerë§Œë“¤ê¸°</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// mocks/handlers.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> rest <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'msw'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> mockData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\tfoo<span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> handlers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  rest<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/test'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> ctx</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>somthing <span class=\"token operator\">===</span> bad<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token function\">res</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">res</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span>mockData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>MMTëŠ” rest apië¥¼ ì‚¬ìš©í•˜ë‹ˆ rest apiì˜ handlerë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.</p>\n<p>ì´ì œ â€œ/testâ€ë¼ëŠ” POST ìš”ì²­ì„ í•˜ê²Œë˜ë©´ {foo: â€˜barâ€™}ë¼ëŠ” ì‘ë‹µì´ ëŒì•„ì˜¤ê²Œ ë  ê²ƒì´ë‹¤.</p>\n<h3>server ë§Œë“¤ê¸°</h3>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// mocks/server.ts</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> setupServer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"msw/node\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handlers <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./handlers\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">setupServer</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>handlers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì„œë¹„ìŠ¤ì›Œì»¤ëŠ” ë¸Œë¼ìš°ì €ìš©ì´ë¼ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ëŠ” <code class=\"language-text\">worker</code>ë¥¼ ì…‹ì—…í•˜ì§€ ì•ŠëŠ”ë‹¤. ëŒ€ì‹  node ê¸°ë°˜ì¸ í…ŒìŠ¤íŠ¸í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” <code class=\"language-text\">server</code> ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.</p>\n<h3>fixture ì¶”ê°€ (Optional)</h3>\n<p>ë‹¤ìŒìœ¼ë¡œ ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ëª¨í‚¹ì´ í•„ìš”í•œ ê²ƒì€ ì•„ë‹ˆë‹ˆ mswê°€ í•„ìš”í•œ í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ fixtureë¥¼ ë§Œë“¤ì–´ë‘”ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// helper/fixture.tsx</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> server <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../../mocks/server\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">prepareMsw</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">beforeAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> server<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> server<span class=\"token punctuation\">.</span><span class=\"token function\">resetHandlers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">afterAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> server<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì´ <code class=\"language-text\">prepareMsw</code>ë¥¼ ë‚˜ì¤‘ì— í•„ìš”í•œ í…ŒìŠ¤íŠ¸ì½”ë“œ ì‹¤í–‰ì „ì— ë¶™ì—¬ë‘ë©´ MSWê°€ apië¥¼ ëª¨í‚¹í•´ì¤€ë‹¤!</p>\n<p>ì´ëŸ¬ë©´ ì´ì œ mswë¥¼ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ëë‚¬ë‹¤ :)</p>\n<h1>ì‹¤ì œ í…ŒìŠ¤íŠ¸ì— ì ìš©í•˜ê¸°</h1>\n<p>ì ìš©ë²•ì€ ë§¤ìš° ê°„ë‹¨í•˜ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token function\">describe</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Custom Dialog test'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">prepareMsw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// (1)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> bad<span class=\"token punctuation\">,</span> good <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> mockEPassData<span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'should return value, when pass valid data'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> getByTestId<span class=\"token punctuation\">,</span> getByRole <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">renderWithClient</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Dialog</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    userEvent<span class=\"token punctuation\">.</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">(</span><span class=\"token function\">getByTestId</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> good<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token operator\">...</span>\n\n    userEvent<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token function\">getByRole</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token regex\">/ë“±ë¡/i</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// (2)</span>\n\n    <span class=\"token keyword\">await</span> <span class=\"token function\">waitFor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">getByTestId</span><span class=\"token punctuation\">(</span><span class=\"token string\">'success'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span><span class=\"token function\">getByTestId</span><span class=\"token punctuation\">(</span><span class=\"token string\">'success'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toBeVisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>handlerì— ë“±ë¡ëœ apië¥¼ í˜¸ì¶œí•˜ëŠ” í…ŒìŠ¤íŠ¸ì½”ë“œì— (1)ì²˜ëŸ¼ ì•„ê¹Œ ë§Œë“¤ì–´ë‘” <code class=\"language-text\">prepareMsw</code> í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¤ë„ë¡ í•˜ë©´ ëœë‹¤.</p>\n<p>í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‹¤í–‰í•´ë³´ë©´ ì‹¤ì œ ìœ ì €ê°€ í–‰ë™í•˜ëŠ” ê²ƒì²˜ëŸ¼ submit ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì‹¤ì œ ì»´í¬ë„ŒíŠ¸ì—ì„œ POST í˜¸ì¶œì„ í•˜ê²Œë  ê²ƒì´ê³ , MSWê°€ ê·¸ ìš”ì²­ì„ ê°€ë¡œì±„ì„œ ì¤€ë¹„í•´ë‘” ê°’ì„ return í•´ì¤€ë‹¤.</p>\n<p>ë”°ë¡œ jest ëª¨í‚¹ì´ë‚˜ ìŠ¤íŒŒì´ ì½”ë“œ ì—†ì´ë„ í…ŒìŠ¤íŠ¸ì½”ë“œê°€ í„°ì§€ì§€ ì•ŠëŠ”ë‹¤.(ì´ ë¶€ë¶„ì´ ìƒì‚°ì„± í–¥ìƒì„ í¬ê²Œ ëŠë‚€ ë¶€ë¶„ì´ë‹¤)</p>\n<h1>ì‚¬ìš© í›„ ëŠë‚€ì </h1>\n<p>í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ì„œ ê°€ì¥ ë‹µë‹µí•˜ê²Œ ëŠê¼ˆë˜ ìš”ì†Œ ì¤‘ í•˜ë‚˜ê°€, ì‹¤ì œ ì‘ì„±í•œ ì»´í¬ë„ŒíŠ¸/í›… ì˜ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•˜ë ¤ê³  ì½”ë“œë¥¼ ì§°ì„ë•Œ ì•±ì˜ ê¸°ëŠ¥ê³¼ ê´€ë ¨ì—†ëŠ” ë¶€ë¶„ì„ íšŒí”¼í•˜ê¸° ìœ„í•´ ì ì§€ì•Šì€ ì–‘ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë“¤ì—¬ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ í¬ê²Œ ëŠê»´ì¡ŒëŠ”ë° ì´ëŸ° ë¶€ë¶„ì„ í•´ì†Œí•´ì¤˜ì„œ ì¢‹ì•˜ë‹¤.</p>\n<p>ë•ë¶„ì— ì½”ë“œ ì‘ì—…ëŸ‰ì´ ì¤„ì–´ë“¤ê³  í…ŒìŠ¤íŠ¸ì½”ë“œê°€ ì¢€ ë” ë³¸ë˜ í•˜ë ¤ë˜ í…ŒìŠ¤íŠ¸ì— ì§‘ì¤‘í•  ìˆ˜ ìˆê²Œë˜ê³  ì½”ë“œ ê°€ë…ì„±ë„ ì¢‹ì•„ì ¸ì„œ ë§Œì¡±í–ˆë‹¤.</p>\n<p>ì•„ì§ ë¸Œë¼ìš°ì €ì—ëŠ” ì ìš©í•˜ì§€ ì•Šì•˜ì§€ë§Œ ë¸Œë¼ìš°ì €ì—ë„ ì…‹íŒ…í•˜ë©´ ë°±ì—”ë“œ ê°œë°œìë¥¼ ê¸°ë‹¤ë¦´ í•„ìš” ì—†ì´ ë³‘í–‰í•´ì„œ ì¼ì„ í•  ìˆ˜ ìˆì–´ì„œ ì‹œê°„ ì ˆì•½ì—ë„ ë§ì€ ë„ì›€ì´ ë  ê²ƒ ê°™ë‹¤.</p>\n<h1>Referance</h1>\n<ul>\n<li><a href=\"https://mswjs.io/\">https://mswjs.io/</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=v77fjkKQTH0\">https://www.youtube.com/watch?v=v77fjkKQTH0</a></li>\n</ul>","frontmatter":{"title":"í…ŒìŠ¤íŠ¸ í™˜ê²½ì— MSW ë„ì…","date":"December 05, 2021","tags":["react","test","TIL"]}}},"pageContext":{"slug":"/2021/12-05-try-to-use-msw-on-testing/","previous":{"fields":{"slug":"/2021/07-01-use-console-log-like-a-pro/"},"frontmatter":{"title":"Use console.log() like a pro"}},"next":{"fields":{"slug":"/2021/08-09-functional-ish-javascript/"},"frontmatter":{"title":"Functional-ish JavaScript"}}}}}